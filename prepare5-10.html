<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <title>CheckupTracker</title>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.0-beta.1/jquery.mobile-1.3.0-beta.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
   <!-- <script src="ajax/topic91.js" type="text/javascript" /> -->

    <script type="text/javascript" >
        /*
        $(document).bind('pagebeforechange', function (event, data) {
            var url = $.mobile.path.parseUrl(data.toPage).hash;

            if (url!=undefined && url.length>5 && url.substring(0,5)=="#page") {
                var id = url.substring(5);

                //use page template in dom
                //$("#pageTemplate h1").html("Page " + id);

                //change to real page template w/o using real id in history
                $.mobile.changePage($("#pageTemplate"), {dataUrl: data.toPage});

                //prevent page transition
                event.preventDefault();
            }
        });
        */

            $(document).bind('mobileinit', function () {

             $.getJSON("http://healthfinder.gov/Developer/Search.json?api_key=ynyawyrexvuoabvk&TopicID=91", function(json) {
                 var results = json["Result"];
                 var topics = results["Topics"];
                 var sections = topics["Sections"];

                 var htmlString ="<h3>" + topics.Title + "</h3>";
                 var page = ""; //lets write out dynamic content pages as we loop through
                 htmlString += '<ul data-role="listview" data-theme="d" data-divider-theme="d" data-inset="true" >';
                 for (i=0; i<sections.length;i++) {

                     //summary page
                     htmlString += "<li>";
                     htmlString += "<a href='#page" + i + "' >";

                     htmlString += "<h4>" + sections[i].Title + "</h4>";
                     htmlString += "<p>" + sections[i].Description + "</p>";
                     //htmlString += '<p class="ui-li-aside"><strong>6:24</strong>PM</p>';

                     htmlString += "</a>";
                     htmlString += "</li>";

                     //content detail pages
                        //page = $("<div>").jqmData("role", "page").attr("id", "page" + i);
                     //heaader
                        //page = $("h3").html(sections[i].Title )
                        //page += $("#description").html(sections[i].Content );
                     page += '<div data-role="page" data-theme="b" data-add-back-btn="true" id="page' + i + '"><div data-role="header"><h1>CheckupTracker</h1></div><div data-role="content"><h3>' + sections[i].Title + '</h3>' + sections[i].Content + '</div></div>';

                     //$('#page_body').append('<div data-role="page" id="page' + i + '"><div data-role="content">some content here' + page + '</div></div>');


                     //  $("<div>").attr("data-role", "header").append($("<h1>").html("Page " + i)).appendTo(page);
                     //   page += $("<div>").jqmData("role", "content").attr("id", "page" + i);
                     //$header.find( "h3" ).html( sections[i].Title )
                     //content
                     //  $("<div>").attr("data-role", "content").append($("<p>").html("Contents for page " + i )).appendTo(page);
                     //$content.html( "some Content here" );



                 };
                 htmlString += "</ul>";
                 //write all to to DOM
                 $("#page_body").append(page);

                 $("#replaceMe").html(htmlString).trigger( "create" ); //trigger("create") causes jqm to refresh widgets.
             });
         });
    </script>
    <script src="http://code.jquery.com/mobile/1.3.0-beta.1/jquery.mobile-1.3.0-beta.1.min.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">

</head>
<body id="page_body" >

<div data-role="page" data-theme="b" data-add-back-btn="true">

    <div data-role="header">
        <h1>CheckupTracker</h1>
    </div><!-- /header -->

    <div data-role="content">
        <div id="replaceMe"></div>
    </div><!-- /content -->


</div><!-- /page -->

<div data-role="page" data-theme="b" data-add-back-btn="true" id="pageTemplate">

    <div data-role="header">
        <h1>CheckupTracker</h1>
    </div><!-- /header -->

    <div data-role="content">
        <h3>Header</h3>
        <p id="description">Content</p>
    </div><!-- /content -->

    <div data-role="footer">
        <h4>Footer</h4>
    </div><!-- /footer -->

</div><!-- /page -->


</body>
</html>